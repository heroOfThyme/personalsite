---
import type { InferGetStaticPropsType, GetStaticPaths } from 'astro';

import Layout from '~/layouts/PageLayout.astro';
import BlogList from '~/components/blog/List.astro';
import Headline from '~/components/blog/Headline.astro';
import Pagination from '~/components/blog/Pagination.astro';

import { blogListRobots, getStaticPathsBlogList } from '~/utils/blog';

export const prerender = true;

export const getStaticPaths = (async ({ paginate }) => {
  return await getStaticPathsBlogList({ paginate });
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { page } = Astro.props as Props;
const currentPage = page.currentPage ?? 1;

const metadata = {
  title: `Blog${currentPage > 1 ? ` â€” Page ${currentPage}` : ''}`,
  robots: {
    index: blogListRobots?.index && currentPage === 1,
    follow: blogListRobots?.follow,
  },
  openGraph: {
    type: 'blog',
  },
};
---

<Layout metadata={metadata}>
  <div class="blog-container">
    <!-- Back Button -->
    <div class="back-nav">
      <a href="/" class="back-link">
        <svg class="back-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        Back Home
      </a>
    </div>

    <Headline
      subtitle="Thoughts, tips, and insights on technology, design, and my professional journey."
    >
      My Blog
    </Headline>

    <BlogList posts={page.data} />

    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
  </div>
</Layout>

<style>
  .blog-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem 4rem 4rem 4rem;
  }

  /* Back Navigation */
  .back-nav {
    margin-bottom: 2rem;
  }

  .back-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: rgba(15, 23, 42, 0.8);
    border: 1px solid rgba(168, 85, 247, 0.3);
    border-radius: 10px;
    color: #a855f7;
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    transition: all 0.3s ease;
  }

  .back-link:hover {
    border-color: rgba(168, 85, 247, 0.6);
    background: rgba(168, 85, 247, 0.1);
    transform: translateX(-4px);
  }

  .back-icon {
    width: 1rem;
    height: 1rem;
  }

  /* Mobile Responsive */
  @media (max-width: 1024px) {
    .blog-container {
      padding: 2rem;
    }
  }

  @media (max-width: 640px) {
    .blog-container {
      padding: 1rem;
    }
  }
</style>
